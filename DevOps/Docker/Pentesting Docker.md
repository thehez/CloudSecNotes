# Pentesting Docker
- [Pentesting Docker](#pentesting-docker)
- [Enumeration](#enumeration)
  - [Docker Daemon Misconfiguration](#docker-daemon-misconfiguration)
    - [Using Nmap](#using-nmap)
    - [Using Metasploit](#using-metasploit)
    - [Using Curl](#using-curl)
    - [Using Docker](#using-docker)

# Enumeration

## Docker Daemon Misconfiguration

The daemon listens on unix:///var/run/docker.sock but you can bind Docker to another host/port or a Unix socket.

The daemon can be configured for remote access, by default, the remote API listens on port 2375 and 2376 for unencrypted and encrypted communication. By default the service does not require authentication allowing an attacker to start a privileged docker container - gaining root access to any containers. By using the Remote API you can attach hosts / (root directory) to the container and read/write files of the hostâ€™s environment.

### Using Nmap
```
nmap -p 2375,2376 <IP> 

nmap -p- -sV --script docker-* <IP>
```

### Using Metasploit
```
msf> use exploit/linux/http/docker_deamon_tcp
```

### Using Curl
```
#check version
curl -s http://open.docker.socket:2375/version | jq

#list containers
curl -insecure https://tlsopen.docker.socket:2376/containers/json | jq
```

### Using Docker
```
docker -H open.docker.socket:2375/version
```

Further information for abusing docker sockets can be found here:
https://securityboulevard.com/2019/02/abusing-docker-api-socket/
